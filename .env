DB_USERNAME=carlos
DB_PASSWORD=6798261677hH-!
DB_NAME=clinicaclick
DB_HOST=localhost
SERVER_IP=15.188.143.57  
MOCK_DATE=2024-06-06
# JWT Configuration - Clave secreta centralizada
JWT_SECRET=6798261677hH-1

# Configuración de cron para sincronizar estadistoicas de meta y tokens de usuarios
JOBS_AUTO_START=true
JOBS_TIMEZONE=Europe/Madrid
JOBS_METRICS_SCHEDULE="10 0 * * *"
JOBS_TOKEN_VALIDATION_SCHEDULE="0 */6 * * *"
JOBS_CLEANUP_SCHEDULE="0 3 * * 0"
JOBS_HEALTH_CHECK_SCHEDULE="0 * * * *" 
JOBS_ADS_MIDDAY_SCHEDULE="0 12 * * *"
JOBS_SYNC_LOGS_RETENTION="7"              # Solo 7 días de logs
JOBS_ADS_SCHEDULE="1 0 * * *"

# Meta API Configuration
META_API_BASE_URL=https://graph.facebook.com/v23.0

# MetaSync posts fallback configuration
# Número de publicaciones recientes a recuperar siempre (además del rango)
METASYNC_POSTS_FALLBACK_LIMIT=30

# Ads Insights fetch configuration
# Días por chunk al pedir insights de Ads (reduce 500/timeout en rangos largos)
ADS_CHUNK_DAYS=3
# Límite de filas por página en llamadas a Ads Insights
ADS_PAGE_LIMIT=100
# Ventanas de sincronización Ads
ADS_SYNC_INITIAL_DAYS=30
ADS_SYNC_RECENT_DAYS=7
ADS_SYNC_MIDDAY_DAYS=2
ADS_SYNC_BACKFILL_DAYS=28
ADS_SYNC_BETWEEN_ACCOUNTS_SLEEP_MS=60000

# Meta API client guardrails
# Retardo suave entre llamadas para no disparar el rate limit (ms)
METASYNC_REQUEST_DELAY_MS=200
# Porcentaje a partir del cual consideramos uso alto y aplicamos backoff
METASYNC_RATE_LIMIT_THRESHOLD=93
# Reintentos de errores no relacionados con rate limit
METASYNC_MAX_RETRIES=3
# Si true, al alcanzar rate limit esperamos hasta la próxima hora (en vez de reintentos cortos)
METASYNC_WAIT_NEXT_HOUR_ON_LIMIT=true

# Ruta del log del proceso (opcional) para endpoint de tail de logs
# Ejemplo con PM2: /home/ubuntu/.pm2/logs/clinicaclick-auth-out.log
PM2_LOG_PATH=/home/ubuntu/.pm2/logs/clinicaclick-auth-out.log
# APP_LOG_PATH=/var/log/clinicaclick-auth.log

# Ads Health default thresholds (parametrizables por querystring)
# Frecuencia máxima para alerta de frecuencia
ADS_HEALTH_FREQ_MAX=3
# CTR mínimo (fracción: 0.005 = 0.5%)
ADS_HEALTH_CTR_MIN=0.005
# CPL máximo en euros
ADS_HEALTH_CPL_MAX=10
# Crecimiento relativo de CPL vs. semana previa (0.3 = +30%)
ADS_HEALTH_CPL_GROWTH=0.3

# Google OAuth / APIs
GOOGLE_CLIENT_ID=4955619485-3sn2homa9ji1btlkb8qb27c3ctjqhfi3.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=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
GOOGLE_REDIRECT_URI=https://autenticacion.clinicaclick.com/oauth/google/callback
# Scopes por defecto para Search Console + identidad básica
GOOGLE_OAUTH_SCOPES="https://www.googleapis.com/auth/webmasters.readonly https://www.googleapis.com/auth/analytics.readonly https://www.googleapis.com/auth/business.manage https://www.googleapis.com/auth/adwords openid email profile"
# API Key para PageSpeed Insights (Lighthouse)
GOOGLE_PSI_API_KEY=AIzaSyC7XC7T-2tA-esq8CwSr5YJWEYV4VyaPmI
WEB_PSI_ENABLED=true
WEB_PSI_ON_BACKFILL=false
WEB_PSI_MIN_HOURS_BETWEEN_RUNS=24

# Google Ads API
GOOGLE_ADS_API_ENDPOINT=https://googleads.googleapis.com
GOOGLE_ADS_DEVELOPER_TOKEN=5HUPpsV6uCfpRQs7tzzeKg
# Usa el MCC sin guiones (286-322-4233 → 2863224233)
GOOGLE_ADS_MANAGER_ID=2863224233
GOOGLE_ADS_API_VERSION=v21
# Opcional: lista de versiones fallback (se probarán en orden si la principal devuelve 404)
GOOGLE_ADS_API_VERSION_FALLBACKS=v20,v19,v18,v17,v16,v15
GOOGLE_ADS_DAILY_QUOTA=1500
GOOGLE_ADS_SYNC_INITIAL_DAYS=30
GOOGLE_ADS_SYNC_RECENT_DAYS=7
GOOGLE_ADS_SYNC_CHUNK_DAYS=7
GOOGLE_ADS_BACKFILL_DAYS=180
GOOGLE_ADS_SYNC_BETWEEN_ACCOUNTS_SLEEP_MS=2000
GOOGLE_ADS_USAGE_THRESHOLD=90
GOOGLE_ADS_HEALTH_MIN_SPEND=1
GOOGLE_ADS_HEALTH_CTR_MIN=0.02
GOOGLE_ADS_HEALTH_CPA_MAX=25
GOOGLE_ADS_HEALTH_CPA_GROWTH=0.3
GOOGLE_ADS_HEALTH_MIN_IMPRESSIONS=200

# Jobs Google Ads
JOBS_GOOGLE_ADS_SCHEDULE="20 5 * * *"
JOBS_GOOGLE_ADS_BACKFILL_SCHEDULE="30 5 * * 0"
